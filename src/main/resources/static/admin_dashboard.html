<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avengers Admin Dashboard</title>
    <!-- Link to the universal theme stylesheet -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- Link to the dashboard-specific stylesheet -->
    <link rel="stylesheet" href="/css/admin_dashboard.css">
    <!-- Font Awesome for icons (used throughout the dashboard) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Font: Inter (for a clean, modern look) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<!-- Body defaults to dark-mode based on the provided style.css setup -->
<body class="dark-mode">
    <!-- Video Background and Overlay -->
    <div class="video-background">
        <!-- Added playsinline for better mobile compatibility -->
        <video autoplay muted loop id="bgVideo" playsinline poster="/images/marvel_intro_poster.jpg">
            <source src="/videos/marvel_intro.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
    <div class="video-overlay"></div>

    <!-- Theme Switch Toggle -->
    <div class="theme-switch-wrapper">
        <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox" checked />
            <div class="slider round"></div>
        </label>
        <em>Dark Mode</em>
    </div>

    <!-- Main Content Wrapper -->
    <div class="content-wrapper">
        <!-- Dashboard Header Section -->
        <header class="dashboard-header">
            <h1 class="dashboard-title">Avengers Command Center</h1>
            <p class="welcome-message">Welcome, <span id="welcomeUsername">Captain!</span></p>
        </header>

        <!-- Container for Sidebar and Main Content to allow them to sit side-by-side -->
        <div class="dashboard-layout-container">
            <!-- Sidebar Navigation -->
            <nav class="sidebar">
                <ul>
                    <li class="nav-item active" data-section="overview"><i class="fas fa-tachometer-alt"></i> Dashboard Overview</li>
                    <li class="nav-item" data-section="payments"><i class="fas fa-dollar-sign"></i> Payments</li>
                    <li class="nav-item" data-section="missions"><i class="fas fa-globe-americas"></i> Missions</li>
                    <li class="nav-item" data-section="attendance"><i class="fas fa-user-check"></i> Attendance</li>
                    <li class="nav-item" data-section="feedback"><i class="fas fa-comments"></i> Feedback</li>
                    <li class="nav-item" data-section="posts"><i class="fas fa-bullhorn"></i> Announcements</li>
                    <li class="nav-item" data-section="users"><i class="fas fa-users"></i> Manage Avengers</li>
                    <li class="nav-item" data-section="stats"><i class="fas fa-chart-line"></i> Stats & Reports</li>
                </ul>
                <!-- Logout Button -->
                <button id="logoutButton" class="button danger-button logout-sidebar-btn">Logout</button>
            </nav>

            <!-- Main Content Area where different sections will be displayed -->
            <main class="dashboard-main-content">
                <!-- Overview Section (Default active section) -->
                <section id="overview" class="dashboard-section active">
                    <h2 class="section-title">Dashboard Overview</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Total Avengers</h3>
                            <p id="totalAvengers">--</p>
                        </div>
                        <div class="stat-card">
                            <h3>Active Missions</h3>
                            <p id="activeMissions">--</p>
                        </div>
                        <div class="stat-card">
                            <h3>Pending Feedback</h3>
                            <p id="pendingFeedback">--</p>
                        </div>
                        <div class="stat-card">
                            <h3>Total Payments Sent (This Month)</h3>
                            <p id="totalPayments">₹ --</p>
                        </div>
                    </div>
                </section>

                <!-- Payments Section -->
                <section id="payments" class="dashboard-section hidden">
                    <h2 class="section-title">Payments Management</h2>
                    <div class="card">
                        <h3>Send Salaries</h3>
                        <form id="sendSalaryForm" class="payment-form">
                            <div class="form-group">
                                <label for="salary-recipient">Recipient Avenger:</label>
                                <select id="salary-recipient" class="input-field" required>
                                    <option value="">Select Avenger</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="salary-amount">Amount (₹):</label>
                                <input type="number" id="salary-amount" class="input-field" placeholder="e.g., 50000" min="1" required>
                            </div>
                            <div class="form-group">
                                <label for="salary-type">Payment Type:</label>
                                <select id="salary-type" class="input-field" required>
                                    <option value="SEND_MONEY">Send Money</option>
                                    <option value="SALARY">Salary</option>
                                </select>
                            </div>
                            <div class="form-group advanced-amount-group hidden">
                                <label for="advanced-amount">Advanced Amount (₹):</label>
                                <input type="number" id="advanced-amount" class="input-field" placeholder="e.g., 10000" min="0">
                            </div>
                            <button type="submit" class="button primary-button">Send Payment</button>
                        </form>
                        <div id="paymentMessage" class="message mt-2"></div>
                    </div>

                    <div class="card mt-4">
                        <h3>Payment Records</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Sender</th>
                                    <th>Recipient</th>
                                    <th>Amount</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody id="paymentRecordsTableBody">
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Missions Section -->
                <section id="missions" class="dashboard-section hidden">
                    <h2 class="section-title">Mission Management</h2>
                    <div class="card">
                        <h3>Assign New Mission</h3>
                        <form id="assignMissionForm" class="mission-form">
                            <div class="form-group">
                                <label for="mission-name">Mission Name:</label>
                                <input type="text" id="mission-name" class="input-field" placeholder="e.g., Hydra Base Infiltration" required>
                            </div>
                            <div class="form-group">
                                <label for="mission-description">Description:</label>
                                <textarea id="mission-description" class="input-field" rows="3" placeholder="Detailed mission brief..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="mission-members">Assign Members:</label>
                                <select id="mission-members" class="input-field" multiple required>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="mission-status">Status:</label>
                                <select id="mission-status" class="input-field" required>
                                    <option value="ONGOING">Ongoing</option>
                                    <option value="COMPLETED">Completed</option>
                                    <option value="FAILED">Failed</option>
                                    <option value="MARTYRED">Martyred</option>
                                </select>
                            </div>
                            <button type="submit" class="button primary-button">Assign Mission</button>
                        </form>
                        <div id="missionMessage" class="message mt-2"></div>
                    </div>

                    <div class="card mt-4">
                        <h3>Current Missions</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Mission Name</th>
                                    <th>Description</th>
                                    <th>Members</th>
                                    <th>Status</th>
                                    <th>Assigned By</th>
                                    <th>Created At</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="missionsTableBody">
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Attendance Section -->
                <section id="attendance" class="dashboard-section hidden">
                    <h2 class="section-title">Attendance System</h2>
                    <div class="card">
                        <h3>Start Attendance Session</h3>
                        <button id="start-attendance-btn" class="button primary-button">Generate Attendance Code</button>
                        <div id="attendance-code-display" class="attendance-code-display hidden mt-3">
                            <p>Code: <span id="attendance-code"></span> (Valid for <span id="countdown">60</span> seconds)</p>
                        </div>
                        <div id="attendanceSessionMessage" class="message mt-2"></div>
                    </div>
                    <div class="card mt-4">
                        <h3>Attendance Records</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Session Code</th>
                                    <th>Avenger</th>
                                    <th>Marked At</th>
                                </tr>
                            </thead>
                            <tbody id="attendanceRecordsTableBody">
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Feedback Section -->
                <section id="feedback" class="dashboard-section hidden">
                    <h2 class="section-title">Received Feedback</h2>
                    <div class="card">
                        <p>Feedback received from Avengers:</p>
                        <div id="feedbackList">
                            <p class="no-data-message">No feedback received yet.</p>
                        </div>
                    </div>
                </section>

                <!-- Announcements Section -->
                <section id="posts" class="dashboard-section hidden">
                    <h2 class="section-title">Announcements</h2>
                    <div class="card">
                        <h3>Create New Announcement</h3>
                        <form id="createAnnouncementForm" class="announcement-form">
                            <div class="form-group">
                                <label for="announcement-title">Title:</label>
                                <input type="text" id="announcement-title" class="input-field" placeholder="e.g., Important Update: New Training Protocol" required>
                            </div>
                            <div class="form-group">
                                <label for="announcement-content">Content:</label>
                                <textarea id="announcement-content" class="input-field" rows="5" placeholder="Write your announcement here..." required></textarea>
                            </div>
                            <button type="submit" class="button primary-button">Post Announcement</button>
                        </form>
                        <div id="announcementMessage" class="message mt-2"></div>
                    </div>
                    <div class="card mt-4">
                        <h3>Recent Announcements</h3>
                        <div id="announcementsList">
                            <p class="no-data-message">No announcements posted yet.</p>
                        </div>
                    </div>
                </section>

                <!-- Manage Avengers Section -->
                <section id="users" class="dashboard-section hidden">
                    <h2 class="section-title">Manage Avengers</h2>
                    <div class="card">
                        <h3>Avengers Roster</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Balance</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="avengersRosterTableBody">
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Stats & Reports Section -->
                <section id="stats" class="dashboard-section hidden">
                    <h2 class="section-title">Stats & Reports</h2>
                    <div class="card">
                        <h3>Attendance Percentage</h3>
                        <canvas id="attendanceChart" width="400" height="200"></canvas>
                    </div>
                    <div class="card mt-4">
                        <h3>Mission Completion Rate</h3>
                        <canvas id="missionChart" width="400" height="200"></canvas>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Chart.js library for graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Link to the universal style.js for dark mode toggle -->
    <script src="/js/style.js"></script>
    <!-- Link to the dashboard-specific JavaScript file -->
    <script src="/js/admin_dashboard.js"></script>
</body>
</html>
